"use strict";(self["webpackChunkhousehold_services"]=self["webpackChunkhousehold_services"]||[]).push([[967],{844:(e,t,s)=>{s.d(t,{Er:()=>l,YR:()=>c,xZ:()=>n,y1:()=>o});var a=s(194),r=s(997);const i=a.A.create({baseURL:"http://localhost:8080",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});i.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers["Authorization"]=`Bearer ${t}`),e}),(e=>(console.error("Request error:",e),Promise.reject(e)))),i.interceptors.response.use((e=>e),(e=>{if(console.error("Response error:",e.response?.data||e.message),e.response){switch(e.response.status){case 401:localStorage.removeItem("token"),localStorage.removeItem("user"),r.A.push("/login");break;case 403:r.A.push("/");break;case 500:console.error("Server error:",e.response.data);break}if(e.response.data&&e.response.data.message)return Promise.reject(new Error(e.response.data.message))}return Promise.reject(e)}));const o={async register(e){try{if("professional"===e.role&&!e.service_type)throw new Error("Professionals must select a service type.");console.log("Sending registration data:",e);const t=await i.post("/auth/register",e);return console.log("Registration response:",t.data),t.data}catch(t){throw console.error("Registration error:",t.response?.data||t.message),t.response?.data||{message:"Registration failed. Please try again."}}},async login(e){try{console.log("Attempting login:",e);const t=await i.post("/auth/login",e);if(console.log("Login response:",t.data),t.data.token){localStorage.setItem("token",t.data.token),localStorage.setItem("user",JSON.stringify(t.data.user));const e=t.data.user;r.A.push(`/${e.role}/dashboard`)}return t.data}catch(t){throw console.error("Login error:",t.response?.data||t.message),t}},async logout(){try{await i.post("/auth/logout"),localStorage.removeItem("token"),localStorage.removeItem("user"),r.A.push("/login")}catch(e){console.error("Logout error:",e.response?.data||e.message),localStorage.removeItem("token"),localStorage.removeItem("user"),r.A.push("/login")}},getCurrentUser(){const e=localStorage.getItem("user");return e?JSON.parse(e):null}},c={async getServices(e={}){try{const t=await i.get("/api/services",{params:e});return t.data}catch(t){throw console.error("Error fetching services:",t),t}},async mounted(){try{this.services=await this.searchServices(),console.log("Services loaded:",this.services)}catch(e){console.error("Failed to load services:",e)}},async getServiceById(e){try{const t=await i.get(`/api/services/${e}`);return t.data}catch(t){throw console.error("Error fetching service:",t),t}}},n={async getRequests(){try{const e=await i.get("/api/customer/requests");return e.data}catch(e){throw console.error("Error fetching requests:",e),e}},async createRequest(e){try{const t=await i.post("/api/customer/requests",e);return t.data}catch(t){throw console.error("Error creating request:",t),t}},async updateRequest(e,t){try{const s=await i.put(`/api/customer/requests/${e}`,t);return s.data}catch(s){throw console.error("Error updating request:",s),s}},async closeRequest(e){try{const t=await i.put(`/api/customer/requests/${e}/close`);return t.data}catch(t){throw console.error("Error closing request:",t),t}},async addReview(e,t){try{const s=await i.post(`/api/customer/requests/${e}/review`,t);return s.data}catch(s){throw console.error("Error adding review:",s),s}}},l={async getUsers(e=null){try{const t=e?{role:e}:{},s=await i.get("/api/admin/users",{params:t});return s.data}catch(t){throw console.error("Error fetching users:",t),t}},async approveUser(e){try{const t=await i.post(`/api/admin/users/${e}/approve`);return t.data}catch(t){throw console.error("Error approving user:",t),t}},async blockUser(e){try{const t=await i.post(`/api/admin/users/${e}/block`);return t.data}catch(t){throw console.error("Error blocking user:",t),t}},async getServices(){try{const e=await i.get("/api/admin/services");return e.data}catch(e){throw console.error("Error fetching services:",e),e}},async createService(e){try{const t=await i.post("/api/admin/services",e);return t.data}catch(t){throw console.error("Error creating service:",t),t}},async updateService(e,t){try{const s=await i.put(`/api/admin/services/${e}`,t);return s.data}catch(s){throw console.error("Error updating service:",s),s}},async deleteService(e){try{const t=await i.delete(`/api/admin/services/${e}`);return t.data}catch(t){throw console.error("Error deleting service:",t),t}}}},967:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"customer-dashboard"},[t("div",{staticClass:"container py-4"},[t("div",{staticClass:"row mb-4"},[t("div",{staticClass:"col-md-8"},[t("h2",[e._v("Welcome, "+e._s(e.userName)+"!")]),t("p",{staticClass:"text-muted"},[e._v("Manage your service requests and find services")])]),t("div",{staticClass:"col-md-4 text-md-end"},[t("button",{staticClass:"btn btn-primary",on:{click:function(t){e.showNewRequestModal=!0}}},[t("i",{staticClass:"fas fa-plus me-2"}),e._v("New Service Request ")])])]),t("div",{staticClass:"card shadow-sm mb-4"},[t("div",{staticClass:"card-body"},[t("h5",{staticClass:"card-title mb-3"},[e._v("Search Services")]),t("div",{staticClass:"row g-3"},[t("div",{staticClass:"col-md-4"},[t("div",{staticClass:"input-group"},[e._m(0),t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery.name,expression:"searchQuery.name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Service name..."},domProps:{value:e.searchQuery.name},on:{input:[function(t){t.target.composing||e.$set(e.searchQuery,"name",t.target.value)},e.searchServices]}})])]),t("div",{staticClass:"col-md-4"},[t("div",{staticClass:"input-group"},[e._m(1),t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery.pinCode,expression:"searchQuery.pinCode"}],staticClass:"form-control",attrs:{type:"text",placeholder:"PIN code..."},domProps:{value:e.searchQuery.pinCode},on:{input:[function(t){t.target.composing||e.$set(e.searchQuery,"pinCode",t.target.value)},e.searchServices]}})])]),t("div",{staticClass:"col-md-4"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery.category,expression:"searchQuery.category"}],staticClass:"form-select",on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.searchQuery,"category",t.target.multiple?s:s[0])},e.searchServices]}},[t("option",{attrs:{value:""}},[e._v("All Categories")]),e._l(e.categories,(function(s){return t("option",{key:s,domProps:{value:s}},[e._v(" "+e._s(s)+" ")])}))],2)])])])]),t("ul",{staticClass:"nav nav-tabs mb-4"},[t("li",{staticClass:"nav-item"},[t("a",{staticClass:"nav-link",class:{active:"active"===e.activeTab},attrs:{href:"#"},on:{click:function(t){t.preventDefault(),e.activeTab="active"}}},[e._v(" Active Requests ")])]),t("li",{staticClass:"nav-item"},[t("a",{staticClass:"nav-link",class:{active:"completed"===e.activeTab},attrs:{href:"#"},on:{click:function(t){t.preventDefault(),e.activeTab="completed"}}},[e._v(" Completed ")])])]),t("div",{staticClass:"row g-4"},[0===e.filteredRequests.length?t("div",{staticClass:"col-12 text-center py-5"},[t("i",{staticClass:"fas fa-inbox fa-3x text-muted mb-3"}),t("h5",[e._v("No service requests found")]),t("p",{staticClass:"text-muted"},[e._v(e._s("active"===e.activeTab?"Create a new request to get started!":"No completed requests yet."))])]):e._e(),e._l(e.filteredRequests,(function(s){return t("div",{key:s.id,staticClass:"col-md-6"},[t("div",{staticClass:"card h-100 shadow-sm"},[t("div",{staticClass:"card-body"},[t("div",{staticClass:"d-flex justify-content-between align-items-start mb-3"},[t("h5",{staticClass:"card-title mb-0"},[e._v(e._s(s.service.name))]),t("span",{class:e.getStatusBadgeClass(s.status)},[e._v(" "+e._s(s.status)+" ")])]),t("div",{staticClass:"mb-3"},[t("small",{staticClass:"text-muted"},[t("i",{staticClass:"fas fa-calendar me-2"}),e._v(" Requested: "+e._s(e.formatDate(s.created_at))+" ")]),s.completed_at?t("br"):e._e(),s.completed_at?t("small",{staticClass:"text-muted"},[t("i",{staticClass:"fas fa-check-circle me-2"}),e._v(" Completed: "+e._s(e.formatDate(s.completed_at))+" ")]):e._e()]),s.professional?t("div",{staticClass:"mb-3"},[t("strong",[e._v("Professional:")]),t("span",[e._v(e._s(s.professional.professional_name))])]):e._e(),t("p",{staticClass:"card-text"},[e._v(e._s(s.special_instructions||"No special instructions"))]),t("div",{staticClass:"d-flex justify-content-end gap-2"},["pending"===s.status||"assigned"===s.status?t("button",{staticClass:"btn btn-outline-danger btn-sm",on:{click:function(t){return e.closeRequest(s)}}},[t("i",{staticClass:"fas fa-times me-1"}),e._v(" Close ")]):e._e(),"pending"===s.status?t("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(t){return e.editRequest(s)}}},[t("i",{staticClass:"fas fa-edit me-1"}),e._v(" Edit ")]):e._e(),"completed"!==s.status||s.has_review?e._e():t("button",{staticClass:"btn btn-outline-success btn-sm",on:{click:function(t){return e.addReview(s)}}},[t("i",{staticClass:"fas fa-star me-1"}),e._v(" Review ")])])])])])}))],2)]),e.showNewRequestModal?t("div",{staticClass:"modal fade",class:{show:e.showNewRequestModal}},[t("div",{staticClass:"modal-dialog"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[t("h5",{staticClass:"modal-title"},[e._v("New Service Request")]),t("button",{staticClass:"btn-close",attrs:{type:"button"},on:{click:function(t){e.showNewRequestModal=!1}}})]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),e.createRequest.apply(null,arguments)}}},[t("div",{staticClass:"mb-3"},[t("label",{staticClass:"form-label"},[e._v("Service Type")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.newRequest.service_id,expression:"newRequest.service_id"}],staticClass:"form-select",attrs:{required:""},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.newRequest,"service_id",t.target.multiple?s:s[0])}}},[t("option",{attrs:{value:""}},[e._v("Select a service")]),e._l(e.services,(function(s){return t("option",{key:s.id,domProps:{value:s.id}},[e._v(" "+e._s(s.name)+" - â‚¹"+e._s(s.base_price)+" ")])}))],2)]),t("div",{staticClass:"mb-3"},[t("label",{staticClass:"form-label"},[e._v("PIN Code")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.newRequest.pin_code,expression:"newRequest.pin_code"}],staticClass:"form-control",attrs:{type:"text",required:"",pattern:"[0-9]{6}",placeholder:"Enter 6-digit PIN code"},domProps:{value:e.newRequest.pin_code},on:{input:function(t){t.target.composing||e.$set(e.newRequest,"pin_code",t.target.value)}}})]),t("div",{staticClass:"mb-3"},[t("label",{staticClass:"form-label"},[e._v("Special Instructions")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newRequest.special_instructions,expression:"newRequest.special_instructions"}],staticClass:"form-control",attrs:{rows:"3",placeholder:"Any specific requirements or details..."},domProps:{value:e.newRequest.special_instructions},on:{input:function(t){t.target.composing||e.$set(e.newRequest,"special_instructions",t.target.value)}}})]),t("div",{staticClass:"text-end"},[t("button",{staticClass:"btn btn-secondary me-2",attrs:{type:"button"},on:{click:function(t){e.showNewRequestModal=!1}}},[e._v(" Cancel ")]),t("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.isLoading}},[e.isLoading?t("span",{staticClass:"spinner-border spinner-border-sm me-2"}):e._e(),e._v(" Create Request ")])])])])])])]):e._e(),e.showReviewModal?t("div",{staticClass:"modal fade",class:{show:e.showReviewModal}},[t("div",{staticClass:"modal-dialog"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[t("h5",{staticClass:"modal-title"},[e._v("Add Review")]),t("button",{staticClass:"btn-close",attrs:{type:"button"},on:{click:function(t){e.showReviewModal=!1}}})]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),e.submitReview.apply(null,arguments)}}},[t("div",{staticClass:"mb-3"},[t("label",{staticClass:"form-label"},[e._v("Rating")]),t("div",{staticClass:"star-rating"},e._l(5,(function(s){return t("i",{key:s,staticClass:"fas fa-star",class:{active:s<=e.review.rating},on:{click:function(t){e.review.rating=s}}})})),0)]),t("div",{staticClass:"mb-3"},[t("label",{staticClass:"form-label"},[e._v("Comments")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.review.remarks,expression:"review.remarks"}],staticClass:"form-control",attrs:{rows:"3",required:"",placeholder:"Share your experience..."},domProps:{value:e.review.remarks},on:{input:function(t){t.target.composing||e.$set(e.review,"remarks",t.target.value)}}})]),t("div",{staticClass:"text-end"},[t("button",{staticClass:"btn btn-secondary me-2",attrs:{type:"button"},on:{click:function(t){e.showReviewModal=!1}}},[e._v(" Cancel ")]),t("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.isLoading}},[e.isLoading?t("span",{staticClass:"spinner-border spinner-border-sm me-2"}):e._e(),e._v(" Submit Review ")])])])])])])]):e._e()])},r=[function(){var e=this,t=e._self._c;return t("span",{staticClass:"input-group-text"},[t("i",{staticClass:"fas fa-search"})])},function(){var e=this,t=e._self._c;return t("span",{staticClass:"input-group-text"},[t("i",{staticClass:"fas fa-map-marker-alt"})])}],i=s(844);const o={name:"CustomerDashboard",data(){return{userName:JSON.parse(localStorage.getItem("user"))?.name||"Customer",activeTab:"active",searchQuery:{name:"",pinCode:"",category:""},services:[],categories:[],serviceRequests:[],showNewRequestModal:!1,showReviewModal:!1,isLoading:!1,newRequest:{service_id:"",pin_code:"",special_instructions:""},review:{rating:0,remarks:""},selectedRequest:null}},computed:{filteredRequests(){return this.serviceRequests.filter((e=>"active"===this.activeTab?["pending","assigned","in_progress"].includes(e.status):["completed","closed"].includes(e.status)))}},methods:{async fetchServices(){try{const e=await i.YR.getServices();this.services=e,this.categories=[...new Set(e.map((e=>e.category)))]}catch(e){console.error("Error fetching services:",e)}},async fetchRequests(){try{const e=await i.xZ.getRequests();this.serviceRequests=e}catch(e){console.error("Error fetching requests:",e)}},async searchServices(){try{const e=await i.YR.searchServices(this.searchQuery);this.services=e}catch(e){console.error("Error searching services:",e)}},async createRequest(){this.isLoading=!0;try{await i.xZ.createRequest(this.newRequest),this.showNewRequestModal=!1,this.newRequest={service_id:"",pin_code:"",special_instructions:""},await this.fetchRequests()}catch(e){console.error("Error creating request:",e)}finally{this.isLoading=!1}},async closeRequest(e){if(confirm("Are you sure you want to close this request?"))try{await i.xZ.closeRequest(e.id),await this.fetchRequests()}catch(t){console.error("Error closing request:",t)}},editRequest(e){console.log("Edit request:",e)},addReview(e){this.selectedRequest=e,this.review={rating:0,remarks:""},this.showReviewModal=!0},async submitReview(){if(this.selectedRequest){this.isLoading=!0;try{await i.xZ.addReview(this.selectedRequest.id,this.review),this.showReviewModal=!1,await this.fetchRequests()}catch(e){console.error("Error submitting review:",e)}finally{this.isLoading=!1}}},formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},getStatusBadgeClass(e){const t={pending:"badge bg-warning",assigned:"badge bg-info",in_progress:"badge bg-primary",completed:"badge bg-success",closed:"badge bg-secondary"};return t[e]||"badge bg-secondary"}},async created(){await Promise.all([this.fetchServices(),this.fetchRequests()])}},c=o;var n=s(656),l=(0,n.A)(c,a,r,!1,null,"e7f0f142",null);const u=l.exports}}]);