{"ast":null,"code":"import { professionalAPI } from '@/services/api';\n// Remove ProfessionalDiagnostics import\n\nexport default {\n  name: 'ProfessionalDashboard',\n  components: {\n    // Remove ProfessionalDiagnostics component registration\n  },\n  data() {\n    return {\n      professionalName: '',\n      activeTab: 'pending',\n      loading: true,\n      serviceRequests: [],\n      availableCustomerRequests: [],\n      // For new requests\n      profile: {\n        service_type: '',\n        experience: 0,\n        average_rating: 0,\n        total_reviews: 0,\n        is_approved: false,\n        description: '',\n        email: '',\n        phone: '',\n        date_created: new Date().toISOString()\n      },\n      reviews: [],\n      showDetailsModal: false,\n      showProfileModal: false,\n      selectedRequest: null,\n      isAvailable: true,\n      updatingProfile: false,\n      profileForm: {\n        description: '',\n        phone: '',\n        experience: 0\n      },\n      error: null,\n      // Remove showDiagnostics property\n      isDevelopment: process.env.NODE_ENV === 'development',\n      current_user: null,\n      debugAllPendingRequests: null\n    };\n  },\n  computed: {\n    pendingRequests() {\n      // Add proper return statement\n      return [...this.serviceRequests.filter(req => req.status === 'pending'), ...this.availableCustomerRequests];\n    },\n    inProgressRequests() {\n      return this.serviceRequests.filter(req => req.status === 'in_progress' || req.status === 'assigned') || [];\n    },\n    completedRequests() {\n      return this.serviceRequests.filter(req => req.status === 'completed' || req.status === 'closed') || [];\n    },\n    filteredRequests() {\n      switch (this.activeTab) {\n        case 'pending':\n          return this.pendingRequests;\n        case 'assigned':\n          return this.inProgressRequests;\n        case 'completed':\n          return this.completedRequests;\n        default:\n          return [];\n      }\n    }\n  },\n  created() {\n    this.fetchData();\n  },\n  methods: {\n    checkAuth() {\n      const token = localStorage.getItem('token');\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\n\n      // Store current user for debugging\n      this.current_user = user;\n      if (!token) {\n        console.log('No authentication token found - redirecting to login');\n        // Add a small delay to prevent navigation errors during component initialization\n        setTimeout(() => {\n          this.$router.push('/login');\n        }, 100);\n        return false;\n      }\n      if (user.role !== 'professional') {\n        console.log('User is not a professional - redirecting');\n        setTimeout(() => {\n          this.$router.push('/login');\n        }, 100);\n        return false;\n      }\n      this.professionalName = user.name || 'Professional';\n      return true;\n    },\n    async fetchData() {\n      try {\n        // Only proceed if authentication check passed\n        if (!this.checkAuth()) {\n          return;\n        }\n        this.loading = true;\n        this.error = null;\n\n        // Only fetch data if we have a token\n        const token = localStorage.getItem('token');\n        if (!token) {\n          throw new Error('Authentication required');\n        }\n        await Promise.all([this.fetchProfile(), this.fetchRequests()]);\n      } catch (error) {\n        console.error('Dashboard data fetch error:', error);\n        this.error = error.message || 'Failed to load dashboard data';\n\n        // If token is missing or invalid, redirect to login\n        if (error.message.includes('authentication') || error.message.includes('token')) {\n          setTimeout(() => this.$router.push('/login'), 1000);\n        }\n      } finally {\n        this.loading = false;\n      }\n    },\n    async fetchProfile() {\n      try {\n        const profileData = await professionalAPI.getProfile();\n        this.profile = {\n          ...this.profile,\n          ...profileData\n        };\n\n        // Initialize profile form with current values\n        this.profileForm.description = profileData.description || '';\n        this.profileForm.phone = profileData.phone || '';\n        this.profileForm.experience = profileData.experience || 0;\n      } catch (error) {\n        console.error('Failed to load profile data:', error);\n        // Continue with default profile values\n      }\n    },\n    async fetchRequests() {\n      try {\n        this.loading = true;\n\n        // Clear previous data to avoid displaying stale information\n        this.serviceRequests = [];\n        this.availableCustomerRequests = [];\n\n        // Debug auth token\n        const token = localStorage.getItem('token');\n        console.log('Using token for requests (first 10 chars):', token ? token.substring(0, 10) + '...' : 'No token');\n\n        // Get all service requests assigned to this professional\n        console.log('Fetching assigned service requests...');\n        try {\n          const requestsData = await professionalAPI.getAssignments();\n          console.log('Assigned requests response:', requestsData);\n          if (Array.isArray(requestsData)) {\n            this.serviceRequests = requestsData.map(request => ({\n              ...request,\n              // Ensure these fields exist even if backend doesn't provide them\n              service: request.service || {\n                name: 'Unknown Service',\n                base_price: 0\n              },\n              customer: request.customer_name || {\n                customer_name: 'Unknown Customer'\n              }\n            }));\n            console.log(`Loaded ${this.serviceRequests.length} assigned service requests`);\n          } else {\n            console.error('Invalid response format for assigned requests:', requestsData);\n          }\n        } catch (assignmentError) {\n          console.error('Error fetching assignments:', assignmentError);\n          this.error = 'Failed to load your assigned service requests: ' + (assignmentError.message || 'Unknown error');\n        }\n\n        // Also get available customer requests that aren't assigned yet\n        try {\n          console.log('Fetching available service requests...');\n          const availableRequests = await professionalAPI.getAvailableRequests();\n          console.log('Available requests response:', availableRequests);\n          if (Array.isArray(availableRequests)) {\n            this.availableCustomerRequests = availableRequests.map(request => ({\n              ...request,\n              // Ensure these fields exist even if backend doesn't provide them\n              service: request.service || {\n                name: 'Unknown Service',\n                base_price: 0\n              },\n              customer: request.customer || {\n                customer_name: 'Unknown Customer'\n              },\n              // Add a flag for UI differentiation\n              isNewRequest: true\n            }));\n            console.log(`Loaded ${this.availableCustomerRequests.length} available customer requests`);\n          } else {\n            console.error('Invalid response format for available requests:', availableRequests);\n          }\n        } catch (error) {\n          console.error('Failed to load available requests:', error);\n          this.availableCustomerRequests = [];\n        }\n\n        // Sort requests by date (newest first)\n        this.serviceRequests.sort((a, b) => {\n          const dateA = a.created_at ? new Date(a.created_at) : new Date(0);\n          const dateB = b.created_at ? new Date(b.created_at) : new Date(0);\n          return dateB - dateA;\n        });\n\n        // Debug counts after loading\n        console.log(`Pending: ${this.pendingRequests.length}, In progress: ${this.inProgressRequests.length}, Completed: ${this.completedRequests.length}`);\n      } catch (error) {\n        console.error('Failed to load service requests:', error);\n        this.error = 'Failed to load service requests. Please try again later.';\n      } finally {\n        this.loading = false;\n\n        // Fetch reviews with error handling\n        this.fetchReviews();\n      }\n    },\n    // Remove setupSampleData method and replace with resetError\n    resetError() {\n      this.error = null;\n      this.fetchData();\n    },\n    // Add a helper method to check if a request is a new available request vs. already assigned\n    isNewCustomerRequest(request) {\n      // Check if it comes from availableCustomerRequests array or is flagged as a new request\n      return request.isNewRequest || this.availableCustomerRequests.some(r => r.id === request.id);\n    },\n    // Add a fetchReviews method with proper error handling\n    async fetchReviews() {\n      try {\n        console.log('Fetching professional reviews...');\n        const reviewsData = await professionalAPI.getReviews();\n        if (Array.isArray(reviewsData)) {\n          this.reviews = reviewsData;\n          console.log(`Loaded ${this.reviews.length} reviews`);\n        } else {\n          console.error('Invalid reviews response format:', reviewsData);\n          this.reviews = [];\n        }\n      } catch (error) {\n        console.error('Failed to load reviews:', error);\n        this.reviews = []; // Set to empty array on error\n      }\n    },\n    async acceptRequest(requestId, closeModal = false) {\n      try {\n        this.loading = true;\n        console.log(`Attempting to accept service request ${requestId}`);\n\n        // Get the request either from service requests or available requests\n        let request = this.serviceRequests.find(r => r.id === requestId);\n        if (!request) {\n          request = this.availableCustomerRequests.find(r => r.id === requestId);\n        }\n        if (!request) {\n          throw new Error('Request not found');\n        }\n\n        // Check if the request can be accepted\n        if (request.status !== 'pending') {\n          alert('This request cannot be accepted in its current state.');\n          return;\n        }\n\n        // Accept the request - log the API calls\n        console.log(`Calling API to update status of request ${requestId} to in_progress`);\n        await professionalAPI.updateStatus(requestId, 'in_progress');\n        console.log('Status update API call completed successfully');\n\n        // Refresh data\n        await this.fetchData();\n        if (closeModal) {\n          this.showDetailsModal = false;\n        }\n\n        // Show success notification\n        alert('Service request accepted successfully. You can find it in the \"In Progress\" tab.');\n      } catch (error) {\n        console.error('Error accepting request:', error);\n        alert('Failed to accept request: ' + (error.message || 'Unknown error'));\n      } finally {\n        this.loading = false;\n      }\n    },\n    async rejectRequest(requestId, closeModal = false) {\n      if (confirm('Are you sure you want to reject this request?')) {\n        try {\n          this.loading = true;\n\n          // Get the request either from service requests or available requests\n          let request = this.serviceRequests.find(r => r.id === requestId);\n          if (!request) {\n            request = this.availableCustomerRequests.find(r => r.id === requestId);\n          }\n          if (!request) {\n            throw new Error('Request not found');\n          }\n\n          // Check if the request can be rejected\n          if (request.status !== 'pending' && request.status !== 'available') {\n            alert('This request cannot be rejected in its current state.');\n            return;\n          }\n\n          // Get rejection reason first\n          const reason = prompt('Please provide a reason for rejection (optional):');\n\n          // Reject the request\n          await professionalAPI.updateStatus(requestId, 'rejected');\n\n          // Add rejection reason if provided\n          if (reason && reason.trim()) {\n            await professionalAPI.addRejectionReason(requestId, reason);\n          }\n\n          // Refresh data\n          await this.fetchData();\n          if (closeModal) {\n            this.showDetailsModal = false;\n          }\n          alert('Service request has been rejected.');\n        } catch (error) {\n          console.error('Error rejecting request:', error);\n          alert('Failed to reject request: ' + (error.message || 'Unknown error'));\n        } finally {\n          this.loading = false;\n        }\n      }\n    },\n    async completeRequest(requestId, closeModal = false) {\n      try {\n        this.loading = true;\n        const request = this.serviceRequests.find(r => r.id === requestId);\n        if (!request) {\n          throw new Error('Request not found');\n        }\n\n        // Check if the request is in progress\n        if (request.status !== 'in_progress' && request.status !== 'assigned') {\n          alert('Only in-progress requests can be marked as completed.');\n          return;\n        }\n        let locationExitConfirmed = false;\n\n        // Check if location exit is confirmed\n        if (closeModal && this.selectedRequest) {\n          // Use the modal's exit confirmation checkbox\n          if (!this.selectedRequest.exited_location) {\n            alert('You must confirm you have exited the customer location before completing the service.');\n            this.loading = false;\n            return;\n          }\n          locationExitConfirmed = true;\n        } else {\n          // If not in modal, ask for confirmation\n          if (confirm('Have you exited the customer location? This is required before completing the service.')) {\n            locationExitConfirmed = true;\n          } else {\n            this.loading = false;\n            return;\n          }\n        }\n\n        // Confirm location exit first\n        if (locationExitConfirmed) {\n          await professionalAPI.confirmLocationExit(requestId);\n\n          // Now complete the request\n          await professionalAPI.updateStatus(requestId, 'completed');\n\n          // Refresh data\n          await this.fetchData();\n          if (closeModal) {\n            this.showDetailsModal = false;\n          }\n          alert('Service request marked as completed successfully. The customer will be notified to close the service.');\n        }\n      } catch (error) {\n        console.error('Error completing request:', error);\n        alert('Failed to complete the request: ' + (error.message || 'Unknown error'));\n      } finally {\n        this.loading = false;\n      }\n    },\n    viewRequestDetails(request) {\n      // Add the exited_location property if needed\n      this.selectedRequest = {\n        ...request,\n        exited_location: request.exited_location || false\n      };\n      this.showDetailsModal = true;\n    },\n    async updateAvailability() {\n      try {\n        await professionalAPI.updateAvailability(this.isAvailable);\n        alert(`You are now ${this.isAvailable ? 'available' : 'unavailable'} for new service requests.`);\n      } catch (error) {\n        console.error('Error updating availability:', error);\n        // Revert to previous state if there was an error\n        this.isAvailable = !this.isAvailable;\n      }\n    },\n    async updateProfile() {\n      try {\n        this.updatingProfile = true;\n        await professionalAPI.updateProfile(this.profileForm);\n\n        // Update local profile data\n        this.profile.description = this.profileForm.description;\n        this.profile.phone = this.profileForm.phone;\n        this.profile.experience = this.profileForm.experience;\n        alert('Profile updated successfully!');\n      } catch (error) {\n        console.error('Error updating profile:', error);\n        alert('Failed to update profile. Please try again.');\n      } finally {\n        this.updatingProfile = false;\n      }\n    },\n    formatDate(dateString) {\n      if (!dateString) return 'N/A';\n      const date = new Date(dateString);\n      return date.toLocaleString('en-US', {\n        year: 'numeric',\n        month: 'short',\n        day: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    },\n    getStatusBadgeClass(status) {\n      const classes = {\n        pending: 'badge bg-warning',\n        rejected: 'badge bg-danger',\n        in_progress: 'badge bg-primary',\n        assigned: 'badge bg-info',\n        completed: 'badge bg-success',\n        closed: 'badge bg-secondary'\n      };\n      return classes[status] || 'badge bg-secondary';\n    },\n    getEmptyStateMessage() {\n      if (this.activeTab === 'pending') {\n        return 'No new service requests available at the moment. Check back later.';\n      } else if (this.activeTab === 'assigned') {\n        return 'You have no active service assignments.';\n      } else {\n        return 'You have not completed any service requests yet.';\n      }\n    },\n    // Add a specific method for refreshing requests\n    async refreshRequests() {\n      try {\n        console.log(\"Manually refreshing requests...\");\n        this.loading = true;\n\n        // First check the professional's profile and service type\n        const profileData = await professionalAPI.getProfile();\n        console.log(\"Professional profile:\", profileData);\n\n        // Then fetch customer requests\n        await this.fetchRequests();\n        console.log(\"Refresh completed\");\n      } catch (error) {\n        console.error(\"Error refreshing requests:\", error);\n        this.error = `Error refreshing: ${error.message}`;\n      } finally {\n        this.loading = false;\n      }\n    },\n    // Method to see ALL pending requests in the system\n    async refreshAllPendingRequests() {\n      try {\n        this.loading = true;\n        console.log(\"Fetching ALL pending requests (debug mode)\");\n        const result = await professionalAPI.getAllPendingRequests();\n        this.debugAllPendingRequests = result;\n        console.log(\"All pending requests:\", this.debugAllPendingRequests);\n      } catch (error) {\n        console.error(\"Error fetching all pending requests:\", error);\n        this.error = `Error: ${error.message}`;\n      } finally {\n        this.loading = false;\n      }\n    },\n    // Method to force-accept a request even if it doesn't match service type\n    async forceAcceptRequest(requestId) {\n      if (confirm(`Are you sure you want to accept request #${requestId}?`)) {\n        try {\n          this.loading = true;\n          console.log(`Force-accepting request ${requestId}...`);\n          await professionalAPI.updateStatus(requestId, 'in_progress');\n          alert(`Request #${requestId} accepted successfully!`);\n\n          // Refresh both regular requests and debug data\n          await this.fetchRequests();\n          await this.refreshAllPendingRequests();\n        } catch (error) {\n          console.error(\"Error force-accepting request:\", error);\n          alert(`Error: ${error.message}`);\n        } finally {\n          this.loading = false;\n        }\n      }\n    }\n  },\n  mounted() {\n    // Don't call fetchData here since we're doing it in created/checkAuth\n  }\n};","map":{"version":3,"names":["professionalAPI","name","components","data","professionalName","activeTab","loading","serviceRequests","availableCustomerRequests","profile","service_type","experience","average_rating","total_reviews","is_approved","description","email","phone","date_created","Date","toISOString","reviews","showDetailsModal","showProfileModal","selectedRequest","isAvailable","updatingProfile","profileForm","error","isDevelopment","process","env","NODE_ENV","current_user","debugAllPendingRequests","computed","pendingRequests","filter","req","status","inProgressRequests","completedRequests","filteredRequests","created","fetchData","methods","checkAuth","token","localStorage","getItem","user","JSON","parse","console","log","setTimeout","$router","push","role","Error","Promise","all","fetchProfile","fetchRequests","message","includes","profileData","getProfile","substring","requestsData","getAssignments","Array","isArray","map","request","service","base_price","customer","customer_name","length","assignmentError","availableRequests","getAvailableRequests","isNewRequest","sort","a","b","dateA","created_at","dateB","fetchReviews","resetError","isNewCustomerRequest","some","r","id","reviewsData","getReviews","acceptRequest","requestId","closeModal","find","alert","updateStatus","rejectRequest","confirm","reason","prompt","trim","addRejectionReason","completeRequest","locationExitConfirmed","exited_location","confirmLocationExit","viewRequestDetails","updateAvailability","updateProfile","formatDate","dateString","date","toLocaleString","year","month","day","hour","minute","getStatusBadgeClass","classes","pending","rejected","in_progress","assigned","completed","closed","getEmptyStateMessage","refreshRequests","refreshAllPendingRequests","result","getAllPendingRequests","forceAcceptRequest","mounted"],"sources":["src/views/ProfessionalDashboard.vue"],"sourcesContent":["<template>\r\n  <div class=\"professional-dashboard\">\r\n    <div class=\"container py-4\">\r\n      <!-- Welcome Section -->\r\n      <div class=\"row mb-4\">\r\n        <div class=\"col-lg-8\">\r\n          <h2>Welcome, {{ professionalName }}!</h2>\r\n          <p class=\"text-muted\">Manage your service assignments and view customer requests</p>\r\n          \r\n          <div class=\"stats-cards row g-3 mt-3\">\r\n            <div class=\"col-md-4\">\r\n              <div class=\"card bg-primary text-white\">\r\n                <div class=\"card-body\">\r\n                  <h6 class=\"card-title\">Pending Requests</h6>\r\n                  <h3 class=\"mb-0\">{{ pendingRequests.length }}</h3>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"col-md-4\">\r\n              <div class=\"card bg-success text-white\">\r\n                <div class=\"card-body\">\r\n                  <h6 class=\"card-title\">In Progress</h6>\r\n                  <h3 class=\"mb-0\">{{ inProgressRequests.length }}</h3>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"col-md-4\">\r\n              <div class=\"card bg-info text-white\">\r\n                <div class=\"card-body\">\r\n                  <h6 class=\"card-title\">Completed</h6>\r\n                  <h3 class=\"mb-0\">{{ completedRequests.length }}</h3>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"col-lg-4 mt-4 mt-lg-0\">\r\n          <div class=\"card\">\r\n            <div class=\"card-body\">\r\n              <h5 class=\"card-title\">Your Service Profile</h5>\r\n              <div class=\"d-flex align-items-center mb-3\">\r\n                <div class=\"rating me-2\">\r\n                  <i v-for=\"i in 5\" :key=\"i\" class=\"fas fa-star\" \r\n                     :class=\"i <= Math.round(profile.average_rating) ? 'text-warning' : 'text-muted'\"></i>\r\n                </div>\r\n                <span>{{ profile.average_rating.toFixed(1) }} / 5 ({{ profile.total_reviews }} reviews)</span>\r\n              </div>\r\n              <p class=\"mb-1\"><strong>Service:</strong> {{ profile.service_type }}</p>\r\n              <p class=\"mb-1\"><strong>Experience:</strong> {{ profile.experience }} years</p>\r\n              <p class=\"mb-0\"><strong>Status:</strong> \r\n                <span class=\"badge\" :class=\"profile.is_approved ? 'bg-success' : 'bg-warning'\">\r\n                  {{ profile.is_approved ? 'Approved' : 'Pending Approval' }}\r\n                </span>\r\n              </p>\r\n              <div class=\"mt-3\">\r\n                <button class=\"btn btn-outline-primary btn-sm\" @click=\"showProfileModal = true\">\r\n                  <i class=\"fas fa-user-edit me-1\"></i> View Full Profile\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Job Availability Toggle -->\r\n      <div class=\"card mb-4\">\r\n        <div class=\"card-body d-flex justify-content-between align-items-center\">\r\n          <div>\r\n            <h5 class=\"mb-0\">Job Availability</h5>\r\n            <p class=\"text-muted mb-0\">Toggle your availability to receive new service requests</p>\r\n          </div>\r\n          <div class=\"form-check form-switch\">\r\n            <input class=\"form-check-input\" type=\"checkbox\" id=\"availabilitySwitch\" v-model=\"isAvailable\" @change=\"updateAvailability\">\r\n            <label class=\"form-check-label\" for=\"availabilitySwitch\">\r\n              <span class=\"badge\" :class=\"isAvailable ? 'bg-success' : 'bg-secondary'\">\r\n                {{ isAvailable ? 'Available' : 'Unavailable' }}\r\n              </span>\r\n            </label>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Requests Tabs -->\r\n      <ul class=\"nav nav-tabs mb-4\">\r\n        <li class=\"nav-item\">\r\n          <a \r\n            class=\"nav-link\" \r\n            :class=\"{ active: activeTab === 'pending' }\"\r\n            @click.prevent=\"activeTab = 'pending'\"\r\n            href=\"#\"\r\n          >\r\n            <i class=\"fas fa-clock me-1\"></i> New Requests\r\n            <span class=\"badge bg-danger ms-1\" v-if=\"pendingRequests.length\">{{ pendingRequests.length }}</span>\r\n          </a>\r\n        </li>\r\n        <li class=\"nav-item\">\r\n          <a \r\n            class=\"nav-link\" \r\n            :class=\"{ active: activeTab === 'assigned' }\"\r\n            @click.prevent=\"activeTab = 'assigned'\"\r\n            href=\"#\"\r\n          >\r\n            <i class=\"fas fa-tools me-1\"></i> In Progress\r\n          </a>\r\n        </li>\r\n        <li class=\"nav-item\">\r\n          <a \r\n            class=\"nav-link\" \r\n            :class=\"{ active: activeTab === 'completed' }\"\r\n            @click.prevent=\"activeTab = 'completed'\"\r\n            href=\"#\"\r\n          >\r\n            <i class=\"fas fa-check-circle me-1\"></i> Completed\r\n          </a>\r\n        </li>\r\n        <li class=\"nav-item\">\r\n          <a \r\n            class=\"nav-link\" \r\n            :class=\"{ active: activeTab === 'reviews' }\"\r\n            @click.prevent=\"activeTab = 'reviews'\"\r\n            href=\"#\"\r\n          >\r\n            <i class=\"fas fa-star me-1\"></i> My Reviews\r\n          </a>\r\n        </li>\r\n      </ul>\r\n\r\n      <!-- Loading State -->\r\n      <div v-if=\"loading\" class=\"text-center my-5\">\r\n        <div class=\"spinner-border text-primary\" role=\"status\">\r\n          <span class=\"visually-hidden\">Loading...</span>\r\n        </div>\r\n        <p class=\"mt-2\">Loading service requests...</p>\r\n      </div>\r\n      \r\n      <!-- Empty State -->\r\n      <div v-else-if=\"filteredRequests.length === 0 && activeTab !== 'reviews'\" class=\"text-center py-5\">\r\n        <i class=\"fas fa-inbox fa-3x text-muted mb-3\"></i>\r\n        <h5>No service requests found</h5>\r\n        <p class=\"text-muted\">{{ getEmptyStateMessage() }}</p>\r\n      </div>\r\n      \r\n      <!-- Service Requests List -->\r\n      <div v-else-if=\"activeTab !== 'reviews'\" class=\"row g-4\">\r\n        <div v-for=\"request in filteredRequests\" :key=\"request.id\" class=\"col-md-6\">\r\n          <div class=\"card h-100\">\r\n            <div class=\"card-header d-flex justify-content-between align-items-center\">\r\n              <span :class=\"getStatusBadgeClass(request.status)\">\r\n                {{ request.status }}\r\n              </span>\r\n              <span class=\"text-muted small\">\r\n                <i class=\"fas fa-calendar me-1\"></i>\r\n                {{ formatDate(request.created_at) }}\r\n              </span>\r\n            </div>\r\n            <div class=\"card-body\">\r\n              <h5 class=\"card-title\">{{ request.service.name }}</h5>\r\n              <p class=\"card-text\">\r\n                <strong>Customer:</strong> {{ request.customer.customer_name }}\r\n              </p>\r\n              <p class=\"card-text\">\r\n                <strong>Location:</strong> PIN Code {{ request.pin_code }}\r\n              </p>\r\nto it              <div class=\"mb-3\">\r\n                <!-- Indicate if this is a new customer request vs. assigned request -->\r\n                <span v-if=\"isNewCustomerRequest(request)\" class=\"badge bg-info mb-2\">New Customer Request</span>\r\n              </div>\r\n              <div class=\"mb-3\">\r\n                <strong>Instructions:</strong> \r\n                <p class=\"small text-muted\">{{ request.special_instructions || 'No special instructions provided.' }}</p>\r\n              </div>\r\n              <div class=\"mb-3\">\r\n                <!-- Actions for pending requests -->\r\n                <template v-if=\"request.status === 'pending'\">\r\n                  <button @click=\"acceptRequest(request.id)\" class=\"btn btn-success btn-sm me-2\">\r\n                    <i class=\"fas fa-check me-1\"></i> Accept\r\n                  </button>\r\n                  <button @click=\"rejectRequest(request.id)\" class=\"btn btn-danger btn-sm me-2\">\r\n                    <i class=\"fas fa-times me-1\"></i> Reject\r\n                  </button>\r\n                </template>\r\n                \r\n                <!-- Actions for in-progress requests -->\r\n                <button v-if=\"request.status === 'in_progress'\" @click=\"completeRequest(request.id)\" class=\"btn btn-primary btn-sm me-2\">\r\n                  <i class=\"fas fa-check-circle me-1\"></i> Mark as Completed\r\n                </button>\r\n                \r\n                <!-- View details button for all requests -->\r\n                <button @click=\"viewRequestDetails(request)\" class=\"btn btn-outline-secondary btn-sm\">\r\n                  <i class=\"fas fa-eye me-1\"></i> Details\r\n                </button>\r\n              </div>\r\n            </div>\r\n            <div v-if=\"request.status === 'completed'\" class=\"card-footer text-muted\">\r\n              <div v-if=\"request.review\" class=\"mt-2\">\r\n                <strong>Customer Review:</strong>\r\n                <div class=\"d-flex align-items-center\">\r\n                  <div class=\"rating me-2\">\r\n                    <i v-for=\"i in 5\" :key=\"i\" class=\"fas fa-star\" \r\n                       :class=\"i <= request.review.rating ? 'text-warning' : 'text-muted'\"></i>\r\n                  </div>\r\n                  <span>{{ request.review.remarks }}</span>\r\n                </div>\r\n              </div>\r\n              <div v-else>\r\n                <i class=\"fas fa-star-half-alt me-1\"></i> Awaiting customer review\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Reviews Tab Content -->\r\n      <div v-if=\"activeTab === 'reviews'\" class=\"reviews-tab\">\r\n        <div v-if=\"reviews.length === 0\" class=\"text-center py-5\">\r\n          <i class=\"fas fa-star fa-3x text-muted mb-3\"></i>\r\n          <h5>No Reviews Yet</h5>\r\n          <p class=\"text-muted\">Complete service requests to receive customer reviews</p>\r\n        </div>\r\n\r\n        <div v-else class=\"card\">\r\n          <div class=\"card-header bg-white\">\r\n            <div class=\"d-flex justify-content-between align-items-center\">\r\n              <h5 class=\"mb-0\">Customer Reviews</h5>\r\n              <div class=\"rating-summary\">\r\n                <span class=\"badge bg-primary rounded-pill\">\r\n                  <i class=\"fas fa-star me-1\"></i> {{ profile.average_rating.toFixed(1) }}/5\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"card-body p-0\">\r\n            <div class=\"list-group list-group-flush\">\r\n              <div v-for=\"review in reviews\" :key=\"review.id\" class=\"list-group-item\">\r\n                <div class=\"d-flex justify-content-between align-items-start mb-2\">\r\n                  <div>\r\n                    <h6 class=\"mb-0\">{{ review.customer_name }}</h6>\r\n                    <small class=\"text-muted\">{{ formatDate(review.date_created) }}</small>\r\n                  </div>\r\n                  <div class=\"rating\">\r\n                    <i v-for=\"i in 5\" :key=\"i\" class=\"fas fa-star\" \r\n                       :class=\"i <= review.rating ? 'text-warning' : 'text-muted'\"></i>\r\n                  </div>\r\n                </div>\r\n                <p class=\"mb-0\">{{ review.remarks }}</p>\r\n                <small class=\"text-muted\">Service: {{ review.service_name }}</small>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Request Details Modal -->\r\n    <div class=\"modal fade\" :class=\"{ show: showDetailsModal }\" v-if=\"showDetailsModal\">\r\n      <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <h5 class=\"modal-title\">Request Details</h5>\r\n            <button type=\"button\" class=\"btn-close\" @click=\"showDetailsModal = false\"></button>\r\n          </div>\r\n          <div class=\"modal-body\" v-if=\"selectedRequest\">\r\n            <div class=\"mb-3\">\r\n              <h6>Service Information</h6>\r\n              <p class=\"mb-1\"><strong>Service:</strong> {{ selectedRequest.service.name }}</p>\r\n              <p class=\"mb-1\"><strong>Price:</strong> â‚¹{{ selectedRequest.service.base_price }}</p>\r\n              <p><strong>Status:</strong> \r\n                <span :class=\"getStatusBadgeClass(selectedRequest.status)\">\r\n                  {{ selectedRequest.status }}\r\n                </span>\r\n              </p>\r\n            </div>\r\n            \r\n            <div class=\"mb-3\">\r\n              <h6>Customer Information</h6>\r\n              <p class=\"mb-1\"><strong>Name:</strong> {{ selectedRequest.customer.customer_name }}</p>\r\n              <p class=\"mb-1\"><strong>Phone:</strong> {{ selectedRequest.customer.phone }}</p>\r\n              <p class=\"mb-1\"><strong>PIN Code:</strong> {{ selectedRequest.pin_code }}</p>\r\n              <p class=\"mb-0\">\r\n                <strong>Address:</strong> {{ selectedRequest.customer.address }}\r\n              </p>\r\n            </div>\r\n            \r\n            <div class=\"mb-3\">\r\n              <h6>Timeline</h6>\r\n              <ul class=\"timeline\">\r\n                <li class=\"mb-2\"><strong>Created:</strong> {{ formatDate(selectedRequest.created_at) }}</li>\r\n                <li v-if=\"selectedRequest.accepted_at\" class=\"mb-2\">\r\n                  <strong>Accepted:</strong> {{ formatDate(selectedRequest.accepted_at) }}\r\n                </li>\r\n                <li v-if=\"selectedRequest.completed_at\" class=\"mb-2\">\r\n                  <strong>Completed:</strong> {{ formatDate(selectedRequest.completed_at) }}\r\n                </li>\r\n                <li v-if=\"selectedRequest.closed_at\">\r\n                  <strong>Closed:</strong> {{ formatDate(selectedRequest.closed_at) }}\r\n                </li>\r\n              </ul>\r\n            </div>\r\n            \r\n            <div class=\"mb-0\">\r\n              <h6>Special Instructions</h6>\r\n              <p class=\"mb-0\">{{ selectedRequest.special_instructions || 'No special instructions provided.' }}</p>\r\n            </div>\r\n\r\n            <div v-if=\"selectedRequest.status === 'in_progress'\" class=\"mt-3\">\r\n              <div class=\"alert alert-warning\">\r\n                <i class=\"fas fa-exclamation-triangle me-2\"></i>\r\n                You must confirm that you have exited the customer location before marking the service as completed.\r\n              </div>\r\n              <div class=\"form-check\">\r\n                <input class=\"form-check-input\" type=\"checkbox\" id=\"exitedLocation\" v-model=\"selectedRequest.exited_location\">\r\n                <label class=\"form-check-label\" for=\"exitedLocation\">\r\n                  <strong>I confirm that I have exited the customer location</strong>\r\n                </label>\r\n              </div>\r\n            </div>\r\n            \r\n            <div v-if=\"selectedRequest.status === 'completed'\" class=\"mt-3\">\r\n              <div class=\"alert alert-success\">\r\n                <i class=\"fas fa-check-circle me-2\"></i>\r\n                You have marked this service as completed. Waiting for customer to close the service.\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button type=\"button\" class=\"btn btn-secondary\" @click=\"showDetailsModal = false\">Close</button>\r\n            \r\n            <!-- Action buttons based on status -->\r\n            <template v-if=\"selectedRequest && selectedRequest.status === 'pending'\">\r\n              <button @click=\"acceptRequest(selectedRequest.id, true)\" class=\"btn btn-success\">\r\n                <i class=\"fas fa-check me-1\"></i> Accept\r\n              </button>\r\n              <button @click=\"rejectRequest(selectedRequest.id, true)\" class=\"btn btn-danger\">\r\n                <i class=\"fas fa-times me-1\"></i> Reject\r\n              </button>\r\n            </template>\r\n            \r\n            <button v-if=\"selectedRequest && selectedRequest.status === 'in_progress'\" \r\n                    @click=\"completeRequest(selectedRequest.id, true)\" \r\n                    class=\"btn btn-primary\"\r\n                    :disabled=\"!selectedRequest.exited_location\">\r\n              <i class=\"fas fa-check-circle me-1\"></i> Mark as Completed\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Profile Modal -->\r\n    <div class=\"modal fade\" :class=\"{ show: showProfileModal }\" v-if=\"showProfileModal\">\r\n      <div class=\"modal-dialog modal-lg\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <h5 class=\"modal-title\">Professional Profile</h5>\r\n            <button type=\"button\" class=\"btn-close\" @click=\"showProfileModal = false\"></button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <div class=\"row\">\r\n              <div class=\"col-md-4 text-center mb-4 mb-md-0\">\r\n                <div class=\"avatar-container mb-3\">\r\n                  <img src=\"https://via.placeholder.com/150\" alt=\"Profile\" class=\"rounded-circle img-thumbnail\">\r\n                </div>\r\n                <h4>{{ professionalName }}</h4>\r\n                <div class=\"rating mb-2\">\r\n                  <i v-for=\"i in 5\" :key=\"i\" class=\"fas fa-star\" \r\n                    :class=\"i <= Math.round(profile.average_rating) ? 'text-warning' : 'text-muted'\"></i>\r\n                  <span class=\"ms-1\">{{ profile.average_rating.toFixed(1) }}/5</span>\r\n                </div>\r\n                <p class=\"badge bg-primary\">{{ profile.service_type }}</p>\r\n              </div>\r\n              \r\n              <div class=\"col-md-8\">\r\n                <div class=\"mb-3\">\r\n                  <h6>About Me</h6>\r\n                  <p>{{ profile.description || 'No description provided.' }}</p>\r\n                </div>\r\n                \r\n                <div class=\"row\">\r\n                  <div class=\"col-md-6 mb-3\">\r\n                    <h6>Experience</h6>\r\n                    <p>{{ profile.experience }} years</p>\r\n                  </div>\r\n                  <div class=\"col-md-6 mb-3\">\r\n                    <h6>Joined</h6>\r\n                    <p>{{ formatDate(profile.date_created) }}</p>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div class=\"mb-3\">\r\n                  <h6>Specialization</h6>\r\n                  <p>{{ profile.service_type }}</p>\r\n                </div>\r\n                \r\n                <div class=\"mb-3\">\r\n                  <h6>Contact Information</h6>\r\n                  <p class=\"mb-1\"><i class=\"fas fa-envelope me-2\"></i> {{ profile.email }}</p>\r\n                  <p class=\"mb-0\"><i class=\"fas fa-phone me-2\"></i> {{ profile.phone || 'Not provided' }}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <hr>\r\n            \r\n            <div class=\"profile-edit-section\">\r\n              <h5 class=\"mb-3\">Edit Profile</h5>\r\n              <form @submit.prevent=\"updateProfile\">\r\n                <div class=\"mb-3\">\r\n                  <label class=\"form-label\">Description</label>\r\n                  <textarea v-model=\"profileForm.description\" class=\"form-control\" rows=\"3\"></textarea>\r\n                </div>\r\n                \r\n                <div class=\"row\">\r\n                  <div class=\"col-md-6 mb-3\">\r\n                    <label class=\"form-label\">Phone</label>\r\n                    <input type=\"tel\" v-model=\"profileForm.phone\" class=\"form-control\">\r\n                  </div>\r\n                  <div class=\"col-md-6 mb-3\">\r\n                    <label class=\"form-label\">Experience (years)</label>\r\n                    <input type=\"number\" v-model=\"profileForm.experience\" class=\"form-control\" min=\"0\">\r\n                  </div>\r\n                </div>\r\n                \r\n                <div class=\"text-end\">\r\n                  <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"updatingProfile\">\r\n                    <span v-if=\"updatingProfile\" class=\"spinner-border spinner-border-sm me-1\"></span>\r\n                    Save Changes\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Error state with more detailed information -->\r\n    <div v-if=\"error\" class=\"alert alert-danger mt-4\">\r\n      <h5><i class=\"fas fa-exclamation-triangle me-2\"></i>Error Loading Dashboard</h5>\r\n      <p>{{ error }}</p>\r\n      <div class=\"mt-2\">\r\n        <button @click=\"resetError\" class=\"btn btn-primary btn-sm me-2\">\r\n          <i class=\"fas fa-sync me-1\"></i> Retry\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Remove ProfessionalDiagnostics component -->\r\n\r\n    <!-- Debug controls (only in development) -->\r\n    <div v-if=\"isDevelopment\" class=\"mt-4 p-3 bg-light rounded\">\r\n      <div class=\"d-flex justify-content-between align-items-center\">\r\n        <h5 class=\"mb-0\">Developer Tools</h5>\r\n        <div>\r\n          <button @click=\"refreshRequests\" class=\"btn btn-primary btn-sm me-2\">\r\n            <i class=\"fas fa-sync me-1\"></i> Refresh Requests\r\n          </button>\r\n          <button @click=\"refreshAllPendingRequests\" class=\"btn btn-warning btn-sm\">\r\n            <i class=\"fas fa-search me-1\"></i> Show All Pending Requests\r\n          </button>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"mt-3\">\r\n        <h6>Debug Information:</h6>\r\n        <div class=\"small\">\r\n          <p class=\"mb-1\"><strong>Professional ID:</strong> {{ current_user?.id || 'Unknown' }}</p>\r\n          <p class=\"mb-1\"><strong>Service Type:</strong> {{ profile.service_type || 'Not specified' }}</p>\r\n          <p class=\"mb-1\"><strong>Assigned Requests:</strong> {{ serviceRequests.length }}</p>\r\n          <p class=\"mb-1\"><strong>Available Requests:</strong> {{ availableCustomerRequests.length }}</p>\r\n          <p class=\"mb-1\"><strong>API Errors:</strong> {{ error || 'None' }}</p>\r\n        </div>\r\n      </div>\r\n      \r\n      <!-- Debug section for all pending requests -->\r\n      <div v-if=\"debugAllPendingRequests\" class=\"mt-3\">\r\n        <h6>All Pending Requests in System:</h6>\r\n        <div class=\"alert alert-info\">\r\n          <p class=\"mb-1\">Total pending requests: {{ debugAllPendingRequests.total_count }}</p>\r\n          <p class=\"mb-0\">These are ALL pending requests in the system, regardless of service type.</p>\r\n        </div>\r\n        \r\n        <div class=\"table-responsive\">\r\n          <table class=\"table table-sm table-striped\">\r\n            <thead>\r\n              <tr>\r\n                <th>ID</th>\r\n                <th>Service</th>\r\n                <th>Category</th>\r\n                <th>Customer</th>\r\n                <th>Created</th>\r\n                <th>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr v-for=\"req in debugAllPendingRequests.requests\" :key=\"req.id\">\r\n                <td>{{ req.id }}</td>\r\n                <td>{{ req.service_info?.name || 'Unknown' }}</td>\r\n                <td>{{ req.service_info?.category || 'Unknown' }}</td>\r\n                <td>{{ req.customer_info?.name || 'Unknown' }}</td>\r\n                <td>{{ formatDate(req.created_at) }}</td>\r\n                <td>\r\n                  <button @click=\"forceAcceptRequest(req.id)\" class=\"btn btn-success btn-sm\">\r\n                    Accept\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { professionalAPI } from '@/services/api';\r\n// Remove ProfessionalDiagnostics import\r\n\r\nexport default {\r\n  name: 'ProfessionalDashboard',\r\n  components: {\r\n    // Remove ProfessionalDiagnostics component registration\r\n  },\r\n  data() {\r\n    return {\r\n      professionalName: '',\r\n      activeTab: 'pending',\r\n      loading: true,\r\n      serviceRequests: [],\r\n      availableCustomerRequests: [], // For new requests\r\n      profile: {\r\n        service_type: '',\r\n        experience: 0,\r\n        average_rating: 0,\r\n        total_reviews: 0,\r\n        is_approved: false,\r\n        description: '',\r\n        email: '',\r\n        phone: '',\r\n        date_created: new Date().toISOString()\r\n      },\r\n      reviews: [],\r\n      showDetailsModal: false,\r\n      showProfileModal: false,\r\n      selectedRequest: null,\r\n      isAvailable: true,\r\n      updatingProfile: false,\r\n      profileForm: {\r\n        description: '',\r\n        phone: '',\r\n        experience: 0\r\n      },\r\n      error: null,\r\n      // Remove showDiagnostics property\r\n      isDevelopment: process.env.NODE_ENV === 'development',\r\n      current_user: null,\r\n      debugAllPendingRequests: null,\r\n    };\r\n  },\r\n  computed: {\r\n    pendingRequests() {\r\n      // Add proper return statement\r\n      return [\r\n        ...this.serviceRequests.filter(req => req.status === 'pending'),\r\n        ...this.availableCustomerRequests\r\n      ];\r\n    },\r\n    \r\n    inProgressRequests() {\r\n      return this.serviceRequests.filter(req => \r\n        req.status === 'in_progress' || req.status === 'assigned'\r\n      ) || [];\r\n    },\r\n    \r\n    completedRequests() {\r\n      return this.serviceRequests.filter(req => \r\n        req.status === 'completed' || req.status === 'closed'\r\n      ) || [];\r\n    },\r\n    \r\n    filteredRequests() {\r\n      switch(this.activeTab) {\r\n        case 'pending':\r\n          return this.pendingRequests;\r\n        case 'assigned':\r\n          return this.inProgressRequests;\r\n        case 'completed':\r\n          return this.completedRequests;\r\n        default:\r\n          return [];\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.fetchData();\r\n  },\r\n  \r\n  methods: {\r\n    checkAuth() {\r\n      const token = localStorage.getItem('token');\r\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\r\n      \r\n      // Store current user for debugging\r\n      this.current_user = user;\r\n      \r\n      if (!token) {\r\n        console.log('No authentication token found - redirecting to login');\r\n        // Add a small delay to prevent navigation errors during component initialization\r\n        setTimeout(() => {\r\n          this.$router.push('/login');\r\n        }, 100);\r\n        return false;\r\n      }\r\n      \r\n      if (user.role !== 'professional') {\r\n        console.log('User is not a professional - redirecting');\r\n        setTimeout(() => {\r\n          this.$router.push('/login');\r\n        }, 100);\r\n        return false;\r\n      }\r\n      \r\n      this.professionalName = user.name || 'Professional';\r\n      return true;\r\n    },\r\n    \r\n    async fetchData() {\r\n      try {\r\n        // Only proceed if authentication check passed\r\n        if (!this.checkAuth()) {\r\n          return;\r\n        }\r\n        \r\n        this.loading = true;\r\n        this.error = null;\r\n        \r\n        // Only fetch data if we have a token\r\n        const token = localStorage.getItem('token')\r\n        if (!token) {\r\n          throw new Error('Authentication required')\r\n        }\r\n        \r\n        await Promise.all([\r\n          this.fetchProfile(),\r\n          this.fetchRequests()\r\n        ])\r\n      } catch (error) {\r\n        console.error('Dashboard data fetch error:', error)\r\n        this.error = error.message || 'Failed to load dashboard data'\r\n        \r\n        // If token is missing or invalid, redirect to login\r\n        if (error.message.includes('authentication') || error.message.includes('token')) {\r\n          setTimeout(() => this.$router.push('/login'), 1000)\r\n        }\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n    async fetchProfile() {\r\n      try {\r\n        const profileData = await professionalAPI.getProfile();\r\n        this.profile = {\r\n          ...this.profile,\r\n          ...profileData\r\n        };\r\n        \r\n        // Initialize profile form with current values\r\n        this.profileForm.description = profileData.description || '';\r\n        this.profileForm.phone = profileData.phone || '';\r\n        this.profileForm.experience = profileData.experience || 0;\r\n      } catch (error) {\r\n        console.error('Failed to load profile data:', error);\r\n        // Continue with default profile values\r\n      }\r\n    },\r\n    async fetchRequests() {\r\n      try {\r\n        this.loading = true;\r\n        \r\n        // Clear previous data to avoid displaying stale information\r\n        this.serviceRequests = [];\r\n        this.availableCustomerRequests = [];\r\n        \r\n        // Debug auth token\r\n        const token = localStorage.getItem('token');\r\n        console.log('Using token for requests (first 10 chars):', token ? token.substring(0, 10) + '...' : 'No token');\r\n        \r\n        // Get all service requests assigned to this professional\r\n        console.log('Fetching assigned service requests...');\r\n        try {\r\n          const requestsData = await professionalAPI.getAssignments();\r\n          console.log('Assigned requests response:', requestsData);\r\n          \r\n          if (Array.isArray(requestsData)) {\r\n            this.serviceRequests = requestsData.map(request => ({\r\n              ...request,\r\n              // Ensure these fields exist even if backend doesn't provide them\r\n              service: request.service || { name: 'Unknown Service', base_price: 0 },\r\n              customer: request.customer_name || { customer_name: 'Unknown Customer' }\r\n            }));\r\n            console.log(`Loaded ${this.serviceRequests.length} assigned service requests`);\r\n          } else {\r\n            console.error('Invalid response format for assigned requests:', requestsData);\r\n          }\r\n        } catch (assignmentError) {\r\n          console.error('Error fetching assignments:', assignmentError);\r\n          this.error = 'Failed to load your assigned service requests: ' + (assignmentError.message || 'Unknown error');\r\n        }\r\n        \r\n        // Also get available customer requests that aren't assigned yet\r\n        try {\r\n          console.log('Fetching available service requests...');\r\n          const availableRequests = await professionalAPI.getAvailableRequests();\r\n          console.log('Available requests response:', availableRequests);\r\n          \r\n          if (Array.isArray(availableRequests)) {\r\n            this.availableCustomerRequests = availableRequests.map(request => ({\r\n              ...request,\r\n              // Ensure these fields exist even if backend doesn't provide them\r\n              service: request.service || { name: 'Unknown Service', base_price: 0 },\r\n              customer: request.customer || { customer_name: 'Unknown Customer' },\r\n              // Add a flag for UI differentiation\r\n              isNewRequest: true\r\n            }));\r\n            console.log(`Loaded ${this.availableCustomerRequests.length} available customer requests`);\r\n          } else {\r\n            console.error('Invalid response format for available requests:', availableRequests);\r\n          }\r\n        } catch (error) {\r\n          console.error('Failed to load available requests:', error);\r\n          this.availableCustomerRequests = [];\r\n        }\r\n        \r\n        // Sort requests by date (newest first)\r\n        this.serviceRequests.sort((a, b) => {\r\n          const dateA = a.created_at ? new Date(a.created_at) : new Date(0);\r\n          const dateB = b.created_at ? new Date(b.created_at) : new Date(0);\r\n          return dateB - dateA;\r\n        });\r\n        \r\n        // Debug counts after loading\r\n        console.log(`Pending: ${this.pendingRequests.length}, In progress: ${this.inProgressRequests.length}, Completed: ${this.completedRequests.length}`);\r\n      } catch (error) {\r\n        console.error('Failed to load service requests:', error);\r\n        this.error = 'Failed to load service requests. Please try again later.';\r\n      } finally {\r\n        this.loading = false;\r\n        \r\n        // Fetch reviews with error handling\r\n        this.fetchReviews();\r\n      }\r\n    },\r\n    \r\n    // Remove setupSampleData method and replace with resetError\r\n    resetError() {\r\n      this.error = null;\r\n      this.fetchData();\r\n    },\r\n    \r\n    // Add a helper method to check if a request is a new available request vs. already assigned\r\n    isNewCustomerRequest(request) {\r\n      // Check if it comes from availableCustomerRequests array or is flagged as a new request\r\n      return request.isNewRequest || this.availableCustomerRequests.some(r => r.id === request.id);\r\n    },\r\n    \r\n    // Add a fetchReviews method with proper error handling\r\n    async fetchReviews() {\r\n      try {\r\n        console.log('Fetching professional reviews...');\r\n        const reviewsData = await professionalAPI.getReviews();\r\n        \r\n        if (Array.isArray(reviewsData)) {\r\n          this.reviews = reviewsData;\r\n          console.log(`Loaded ${this.reviews.length} reviews`);\r\n        } else {\r\n          console.error('Invalid reviews response format:', reviewsData);\r\n          this.reviews = [];\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to load reviews:', error);\r\n        this.reviews = []; // Set to empty array on error\r\n      }\r\n    },\r\n    \r\n    async acceptRequest(requestId, closeModal = false) {\r\n      try {\r\n        this.loading = true;\r\n        \r\n        console.log(`Attempting to accept service request ${requestId}`);\r\n        \r\n        // Get the request either from service requests or available requests\r\n        let request = this.serviceRequests.find(r => r.id === requestId);\r\n        if (!request) {\r\n          request = this.availableCustomerRequests.find(r => r.id === requestId);\r\n        }\r\n        \r\n        if (!request) {\r\n          throw new Error('Request not found');\r\n        }\r\n        \r\n        // Check if the request can be accepted\r\n        if (request.status !== 'pending') {\r\n          alert('This request cannot be accepted in its current state.');\r\n          return;\r\n        }\r\n        \r\n        // Accept the request - log the API calls\r\n        console.log(`Calling API to update status of request ${requestId} to in_progress`);\r\n        await professionalAPI.updateStatus(requestId, 'in_progress');\r\n        console.log('Status update API call completed successfully');\r\n        \r\n        // Refresh data\r\n        await this.fetchData();\r\n        \r\n        if (closeModal) {\r\n          this.showDetailsModal = false;\r\n        }\r\n        \r\n        // Show success notification\r\n        alert('Service request accepted successfully. You can find it in the \"In Progress\" tab.');\r\n      } catch (error) {\r\n        console.error('Error accepting request:', error);\r\n        alert('Failed to accept request: ' + (error.message || 'Unknown error'));\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    \r\n    async rejectRequest(requestId, closeModal = false) {\r\n      if (confirm('Are you sure you want to reject this request?')) {\r\n        try {\r\n          this.loading = true;\r\n          \r\n          // Get the request either from service requests or available requests\r\n          let request = this.serviceRequests.find(r => r.id === requestId);\r\n          if (!request) {\r\n            request = this.availableCustomerRequests.find(r => r.id === requestId);\r\n          }\r\n          \r\n          if (!request) {\r\n            throw new Error('Request not found');\r\n          }\r\n          \r\n          // Check if the request can be rejected\r\n          if (request.status !== 'pending' && request.status !== 'available') {\r\n            alert('This request cannot be rejected in its current state.');\r\n            return;\r\n          }\r\n          \r\n          // Get rejection reason first\r\n          const reason = prompt('Please provide a reason for rejection (optional):');\r\n          \r\n          // Reject the request\r\n          await professionalAPI.updateStatus(requestId, 'rejected');\r\n          \r\n          // Add rejection reason if provided\r\n          if (reason && reason.trim()) {\r\n            await professionalAPI.addRejectionReason(requestId, reason);\r\n          }\r\n          \r\n          // Refresh data\r\n          await this.fetchData();\r\n          \r\n          if (closeModal) {\r\n            this.showDetailsModal = false;\r\n          }\r\n          \r\n          alert('Service request has been rejected.');\r\n        } catch (error) {\r\n          console.error('Error rejecting request:', error);\r\n          alert('Failed to reject request: ' + (error.message || 'Unknown error'));\r\n        } finally {\r\n          this.loading = false;\r\n        }\r\n      }\r\n    },\r\n\r\n    async completeRequest(requestId, closeModal = false) {\r\n      try {\r\n        this.loading = true;\r\n        \r\n        const request = this.serviceRequests.find(r => r.id === requestId);\r\n        if (!request) {\r\n          throw new Error('Request not found');\r\n        }\r\n        \r\n        // Check if the request is in progress\r\n        if (request.status !== 'in_progress' && request.status !== 'assigned') {\r\n          alert('Only in-progress requests can be marked as completed.');\r\n          return;\r\n        }\r\n        \r\n        let locationExitConfirmed = false;\r\n        \r\n        // Check if location exit is confirmed\r\n        if (closeModal && this.selectedRequest) {\r\n          // Use the modal's exit confirmation checkbox\r\n          if (!this.selectedRequest.exited_location) {\r\n            alert('You must confirm you have exited the customer location before completing the service.');\r\n            this.loading = false;\r\n            return;\r\n          }\r\n          locationExitConfirmed = true;\r\n        } else {\r\n          // If not in modal, ask for confirmation\r\n          if (confirm('Have you exited the customer location? This is required before completing the service.')) {\r\n            locationExitConfirmed = true;\r\n          } else {\r\n            this.loading = false;\r\n            return;\r\n          }\r\n        }\r\n        \r\n        // Confirm location exit first\r\n        if (locationExitConfirmed) {\r\n          await professionalAPI.confirmLocationExit(requestId);\r\n          \r\n          // Now complete the request\r\n          await professionalAPI.updateStatus(requestId, 'completed');\r\n          \r\n          // Refresh data\r\n          await this.fetchData();\r\n          \r\n          if (closeModal) {\r\n            this.showDetailsModal = false;\r\n          }\r\n          \r\n          alert('Service request marked as completed successfully. The customer will be notified to close the service.');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error completing request:', error);\r\n        alert('Failed to complete the request: ' + (error.message || 'Unknown error'));\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    \r\n    viewRequestDetails(request) {\r\n      // Add the exited_location property if needed\r\n      this.selectedRequest = {\r\n        ...request,\r\n        exited_location: request.exited_location || false\r\n      };\r\n      this.showDetailsModal = true;\r\n    },\r\n\r\n    async updateAvailability() {\r\n      try {\r\n        await professionalAPI.updateAvailability(this.isAvailable);\r\n        alert(`You are now ${this.isAvailable ? 'available' : 'unavailable'} for new service requests.`);\r\n      } catch (error) {\r\n        console.error('Error updating availability:', error);\r\n        // Revert to previous state if there was an error\r\n        this.isAvailable = !this.isAvailable;\r\n      }\r\n    },\r\n\r\n    async updateProfile() {\r\n      try {\r\n        this.updatingProfile = true;\r\n        await professionalAPI.updateProfile(this.profileForm);\r\n        \r\n        // Update local profile data\r\n        this.profile.description = this.profileForm.description;\r\n        this.profile.phone = this.profileForm.phone;\r\n        this.profile.experience = this.profileForm.experience;\r\n          \r\n        alert('Profile updated successfully!');\r\n      } catch (error) {\r\n        console.error('Error updating profile:', error);\r\n        alert('Failed to update profile. Please try again.');\r\n      } finally {\r\n        this.updatingProfile = false;\r\n      }\r\n    },\r\n\r\n    formatDate(dateString) {\r\n      if (!dateString) return 'N/A';\r\n      const date = new Date(dateString);\r\n      return date.toLocaleString('en-US', {\r\n        year: 'numeric',\r\n        month: 'short',\r\n        day: 'numeric',\r\n        hour: '2-digit',\r\n        minute: '2-digit',\r\n      });\r\n    },\r\n\r\n    getStatusBadgeClass(status) {\r\n      const classes = {\r\n        pending: 'badge bg-warning',\r\n        rejected: 'badge bg-danger',\r\n        in_progress: 'badge bg-primary',\r\n        assigned: 'badge bg-info',\r\n        completed: 'badge bg-success',\r\n        closed: 'badge bg-secondary'\r\n      };\r\n      return classes[status] || 'badge bg-secondary';\r\n    },\r\n\r\n    getEmptyStateMessage() {\r\n      if (this.activeTab === 'pending') {\r\n        return 'No new service requests available at the moment. Check back later.';\r\n      } else if (this.activeTab === 'assigned') {\r\n        return 'You have no active service assignments.';\r\n      } else {\r\n        return 'You have not completed any service requests yet.';\r\n      }\r\n    },\r\n\r\n    // Add a specific method for refreshing requests\r\n    async refreshRequests() {\r\n      try {\r\n        console.log(\"Manually refreshing requests...\");\r\n        this.loading = true;\r\n        \r\n        // First check the professional's profile and service type\r\n        const profileData = await professionalAPI.getProfile();\r\n        console.log(\"Professional profile:\", profileData);\r\n        \r\n        // Then fetch customer requests\r\n        await this.fetchRequests();\r\n        \r\n        console.log(\"Refresh completed\");\r\n      } catch (error) {\r\n        console.error(\"Error refreshing requests:\", error);\r\n        this.error = `Error refreshing: ${error.message}`;\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    \r\n    // Method to see ALL pending requests in the system\r\n    async refreshAllPendingRequests() {\r\n      try {\r\n        this.loading = true;\r\n        console.log(\"Fetching ALL pending requests (debug mode)\");\r\n        \r\n        const result = await professionalAPI.getAllPendingRequests();\r\n        this.debugAllPendingRequests = result;\r\n        \r\n        console.log(\"All pending requests:\", this.debugAllPendingRequests);\r\n      } catch (error) {\r\n        console.error(\"Error fetching all pending requests:\", error);\r\n        this.error = `Error: ${error.message}`;\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    \r\n    // Method to force-accept a request even if it doesn't match service type\r\n    async forceAcceptRequest(requestId) {\r\n      if (confirm(`Are you sure you want to accept request #${requestId}?`)) {\r\n        try {\r\n          this.loading = true;\r\n          \r\n          console.log(`Force-accepting request ${requestId}...`);\r\n          await professionalAPI.updateStatus(requestId, 'in_progress');\r\n          \r\n          alert(`Request #${requestId} accepted successfully!`);\r\n          \r\n          // Refresh both regular requests and debug data\r\n          await this.fetchRequests();\r\n          await this.refreshAllPendingRequests();\r\n        } catch (error) {\r\n          console.error(\"Error force-accepting request:\", error);\r\n          alert(`Error: ${error.message}`);\r\n        } finally {\r\n          this.loading = false;\r\n        }\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    // Don't call fetchData here since we're doing it in created/checkAuth\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.professional-dashboard {\r\n  background-color: #f8f9fa;\r\n  min-height: 100vh;\r\n}\r\n\r\n.card {\r\n  border: none;\r\n  box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);\r\n  transition: transform 0.2s, box-shadow 0.2s;\r\n}\r\n\r\n.card:hover {\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.nav-tabs .nav-link {\r\n  cursor: pointer;\r\n  padding: 0.75rem 1rem;\r\n}\r\n\r\n.badge {\r\n  padding: 0.5em 0.8em;\r\n  font-weight: 500;\r\n}\r\n\r\n.modal.show {\r\n  display: block;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n}\r\n\r\n.rating {\r\n  display: inline-block;\r\n}\r\n\r\n.rating .fas {\r\n  color: #e0e0e0;\r\n}\r\n\r\n.rating .fas.text-warning {\r\n  color: #ffc107;\r\n}\r\n\r\n.timeline {\r\n  list-style: none;\r\n  padding-left: 0;\r\n}\r\n\r\n.timeline li {\r\n  position: relative;\r\n  padding-left: 1.5rem;\r\n}\r\n\r\n.timeline li:before {\r\n  content: \"\";\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0.5rem;\r\n  width: 0.5rem;\r\n  height: 0.5rem;\r\n  border-radius: 50%;\r\n  background-color: #0d6efd;\r\n}\r\n\r\n.avatar-container {\r\n  width: 150px;\r\n  height: 150px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.avatar-container img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n}\r\n\r\n.form-check-input[type=\"checkbox\"] {\r\n  width: 1.25em;\r\n  height: 1.25em;\r\n}\r\n\r\n.list-group-item {\r\n  border-left: none;\r\n  border-right: none;\r\n}\r\n\r\n/* Responsive adjustments */\r\n@media (max-width: 768px) {\r\n  .stats-cards {\r\n    margin-top: 1.5rem;\r\n  }\r\n  \r\n  .card-title {\r\n    font-size: 0.9rem;\r\n  }\r\n}\r\n\r\n/* Add new styles */\r\n.alert {\r\n  border-radius: 0.5rem;\r\n}\r\n\r\n.alert-info {\r\n  background-color: rgba(13, 202, 240, 0.1);\r\n  border-color: rgba(13, 202, 240, 0.2);\r\n  color: #055160;\r\n}\r\n\r\n.alert-warning {\r\n  background-color: rgba(255, 193, 7, 0.1);\r\n  border-color: rgba(255, 193, 7, 0.2);\r\n  color: #664d03;\r\n}\r\n\r\n.alert-success {\r\n  background-color: rgba(25, 135, 84, 0.1);\r\n  border-color: rgba(25, 135, 84, 0.2);\r\n  color: #0f5132;\r\n}\r\n\r\n/* Animation for new items */\r\n@keyframes highlight {\r\n  0% { background-color: rgba(25, 135, 84, 0.2); }\r\n  100% { background-color: transparent; }\r\n}\r\n\r\n.highlight-new {\r\n  animation: highlight 2s ease-out;\r\n}\r\n\r\n.customer-avatar img {\r\n  object-fit: cover;\r\n  border: 2px solid #fff;\r\n}\r\n\r\n/* Add styling for new customer request badges */\r\n.badge.bg-info {\r\n  background-color: #0dcaf0 !important;\r\n  color: #fff;\r\n  font-weight: 500;\r\n  padding: 0.4em 0.7em;\r\n  margin-bottom: 8px;\r\n  display: inline-block;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}