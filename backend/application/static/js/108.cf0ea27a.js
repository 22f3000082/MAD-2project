"use strict";(self["webpackChunkhousehold_services"]=self["webpackChunkhousehold_services"]||[]).push([[108],{108:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"customer-requests container mt-4"},[t("h2",[e._v("My Service Requests")]),e.loading?t("div",{staticClass:"text-center my-5"},[e._m(0)]):e.error?t("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v(" "+e._s(e.error)+" ")]):0===e.requests.length?t("div",{staticClass:"text-center my-5"},[t("p",[e._v("You don't have any service requests yet.")]),t("router-link",{staticClass:"btn btn-primary",attrs:{to:"/customer/services"}},[e._v(" Browse Services ")])],1):t("div",[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-12 mb-4"},[t("div",{staticClass:"card"},[e._m(1),t("div",{staticClass:"card-body p-0"},[t("div",{staticClass:"table-responsive"},[t("table",{staticClass:"table table-striped mb-0"},[e._m(2),t("tbody",e._l(e.requests,(function(s){return t("tr",{key:s.id},[t("td",[e._v(e._s(s.service_name||"Unknown Service"))]),t("td",[e._v(e._s(e.formatDate(s.created_at)))]),t("td",[s.professional_name?t("span",[e._v(e._s(s.professional_name))]):t("span",{staticClass:"text-muted"},[e._v("Not assigned yet")])]),t("td",[t("span",{class:e.getStatusBadgeClass(s.status)},[e._v(" "+e._s(e.formatStatus(s.status))+" ")])]),t("td",["completed"!==s.status||s.has_review?"pending"===s.status?t("button",{staticClass:"btn btn-sm btn-outline-danger",on:{click:function(t){return e.cancelRequest(s.id)}}},[e._v(" Cancel ")]):s.has_review?t("span",{staticClass:"text-success"},[t("i",{staticClass:"fas fa-check-circle"}),e._v(" Reviewed ")]):e._e():t("button",{staticClass:"btn btn-sm btn-outline-primary",on:{click:function(t){return e.openReviewModal(s)}}},[e._v(" Leave Review ")])])])})),0)])])])])])])]),t("div",{staticClass:"modal",class:{"d-block":e.showReviewModal},attrs:{tabindex:"-1","aria-hidden":"true"}},[t("div",{staticClass:"modal-dialog"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[t("h5",{staticClass:"modal-title"},[e._v("Leave a Review")]),t("button",{staticClass:"btn-close",attrs:{type:"button"},on:{click:function(t){e.showReviewModal=!1}}})]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),e.submitReview.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",[e._v("Rating")]),t("div",{staticClass:"star-rating"},e._l(5,(function(s){return t("span",{key:s,on:{click:function(t){e.reviewData.rating=s}}},[t("i",{class:s<=e.reviewData.rating?"fas fa-star text-warning":"far fa-star"})])})),0)]),t("div",{staticClass:"form-group"},[t("label",[e._v("Comments")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.reviewData.remarks,expression:"reviewData.remarks"}],staticClass:"form-control",attrs:{rows:"3",placeholder:"Share your experience...",required:""},domProps:{value:e.reviewData.remarks},on:{input:function(t){t.target.composing||e.$set(e.reviewData,"remarks",t.target.value)}}})]),t("div",{staticClass:"text-right"},[t("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[e._v("Cancel")]),t("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.reviewLoading}},[e.reviewLoading?t("span",{staticClass:"spinner-border spinner-border-sm mr-1"}):e._e(),e._v(" Submit Review ")])])])])])]),e.showReviewModal?t("div",{staticClass:"modal-backdrop fade show"}):e._e()])])},r=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"spinner-border text-primary",attrs:{role:"status"}},[t("span",{staticClass:"sr-only"},[e._v("Loading...")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"card-header bg-primary text-white"},[t("h5",{staticClass:"mb-0"},[e._v("Your Service Requests")])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("Service")]),t("th",[e._v("Date")]),t("th",[e._v("Professional")]),t("th",[e._v("Status")]),t("th",[e._v("Actions")])])])}],i=s(194);const n={name:"CustomerRequests",data(){return{requests:[],loading:!0,error:null,selectedRequest:null,showReviewModal:!1,reviewData:{rating:0,remarks:""},reviewLoading:!1}},created(){this.fetchRequests()},methods:{async fetchRequests(){try{this.loading=!0,this.error=null;const e=await i.A.get("http://localhost:8080/api/customer/requests",{headers:{"Authentication-Token":localStorage.getItem("token")}});this.requests=e.data}catch(e){console.error("Error fetching requests:",e),this.error="Failed to load your service requests. Please try again."}finally{this.loading=!1}},formatDate(e){if(!e)return"N/A";const t=new Date(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},formatStatus(e){if(!e)return"Unknown";const t={pending:"Pending",accepted:"Accepted",completed:"Completed",cancelled:"Cancelled",in_progress:"In Progress",rejected:"Rejected"};return t[e]||e.charAt(0).toUpperCase()+e.slice(1)},getStatusBadgeClass(e){const t={pending:"badge badge-warning",accepted:"badge badge-info",completed:"badge badge-success",cancelled:"badge badge-danger",in_progress:"badge badge-primary",rejected:"badge badge-secondary"};return t[e]||"badge badge-secondary"},openReviewModal(e){this.selectedRequest=e,this.reviewData={rating:0,remarks:""},this.showReviewModal=!0},async submitReview(){if(this.selectedRequest)if(0!==this.reviewData.rating)try{this.reviewLoading=!0,await i.A.post(`http://localhost:8080/api/customer/requests/${this.selectedRequest.id}/review`,this.reviewData,{headers:{"Authentication-Token":localStorage.getItem("token")}}),this.showReviewModal=!1,this.fetchRequests(),this.$toasted.success("Review submitted successfully!")}catch(e){console.error("Error submitting review:",e),this.$toasted.error("Failed to submit review. Please try again.")}finally{this.reviewLoading=!1}else alert("Please select a rating")},async cancelRequest(e){if(confirm("Are you sure you want to cancel this service request?"))try{await i.A.put(`http://localhost:8080/api/customer/requests/${e}/cancel`,{},{headers:{"Authentication-Token":localStorage.getItem("token")}}),this.fetchRequests(),this.$toasted.success("Service request cancelled!")}catch(t){console.error("Error cancelling request:",t),this.$toasted.error("Failed to cancel service request. Please try again.")}}}},o=n;var c=s(656),l=(0,c.A)(o,a,r,!1,null,"1e6a2af1",null);const d=l.exports}}]);