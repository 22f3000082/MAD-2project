"use strict";(self["webpackChunkhousehold_services"]=self["webpackChunkhousehold_services"]||[]).push([[642],{642:(s,a,t)=>{t.r(a),t.d(a,{default:()=>c});var r=function(){var s=this,a=s._self._c;return a("div",{staticClass:"login-container"},[a("div",{staticClass:"container py-5"},[a("div",{staticClass:"row justify-content-center"},[a("div",{staticClass:"col-md-6 col-lg-5"},[a("div",{staticClass:"card shadow"},[a("div",{staticClass:"card-body p-4"},[a("h2",{staticClass:"text-center mb-4"},[s._v("Login")]),a("form",{staticClass:"needs-validation",attrs:{novalidate:""},on:{submit:function(a){return a.preventDefault(),s.handleSubmit.apply(null,arguments)}}},[a("div",{staticClass:"mb-3"},[a("label",{staticClass:"form-label"},[s._v("Email")]),a("div",{staticClass:"input-group"},[s._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:s.formData.email,expression:"formData.email"}],staticClass:"form-control",class:{"is-invalid":s.errors.email},attrs:{type:"email",required:"",placeholder:"Enter your email",autocomplete:"email"},domProps:{value:s.formData.email},on:{input:function(a){a.target.composing||s.$set(s.formData,"email",a.target.value)}}}),a("div",{staticClass:"invalid-feedback"},[s._v(s._s(s.errors.email))])])]),a("div",{staticClass:"mb-4"},[a("label",{staticClass:"form-label"},[s._v("Password")]),a("div",{staticClass:"input-group"},[s._m(1),"checkbox"===(s.showPassword?"text":"password")?a("input",{directives:[{name:"model",rawName:"v-model",value:s.formData.password,expression:"formData.password"}],staticClass:"form-control",class:{"is-invalid":s.errors.password},attrs:{required:"",placeholder:"Enter your password",autocomplete:"current-password",type:"checkbox"},domProps:{checked:Array.isArray(s.formData.password)?s._i(s.formData.password,null)>-1:s.formData.password},on:{change:function(a){var t=s.formData.password,r=a.target,e=!!r.checked;if(Array.isArray(t)){var o=null,i=s._i(t,o);r.checked?i<0&&s.$set(s.formData,"password",t.concat([o])):i>-1&&s.$set(s.formData,"password",t.slice(0,i).concat(t.slice(i+1)))}else s.$set(s.formData,"password",e)}}}):"radio"===(s.showPassword?"text":"password")?a("input",{directives:[{name:"model",rawName:"v-model",value:s.formData.password,expression:"formData.password"}],staticClass:"form-control",class:{"is-invalid":s.errors.password},attrs:{required:"",placeholder:"Enter your password",autocomplete:"current-password",type:"radio"},domProps:{checked:s._q(s.formData.password,null)},on:{change:function(a){return s.$set(s.formData,"password",null)}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:s.formData.password,expression:"formData.password"}],staticClass:"form-control",class:{"is-invalid":s.errors.password},attrs:{required:"",placeholder:"Enter your password",autocomplete:"current-password",type:s.showPassword?"text":"password"},domProps:{value:s.formData.password},on:{input:function(a){a.target.composing||s.$set(s.formData,"password",a.target.value)}}}),a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button"},on:{click:s.togglePassword}},[a("i",{class:s.showPassword?"fas fa-eye-slash":"fas fa-eye"})]),a("div",{staticClass:"invalid-feedback"},[s._v(s._s(s.errors.password))])])]),s.loginError?a("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[a("i",{staticClass:"fas fa-exclamation-circle me-2"}),s._v(" "+s._s(s.loginError)+" ")]):s._e(),a("div",{staticClass:"d-grid gap-2"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:s.isLoading}},[s.isLoading?a("span",{staticClass:"spinner-border spinner-border-sm me-2"}):s._e(),s._v(" "+s._s(s.isLoading?"Logging in...":"Login")+" ")])]),a("p",{staticClass:"text-center mt-3"},[s._v(" Don't have an account? "),a("router-link",{attrs:{to:"/register"}},[s._v("Register here")])],1)])])]),s._m(2)])])])])},e=[function(){var s=this,a=s._self._c;return a("span",{staticClass:"input-group-text"},[a("i",{staticClass:"fas fa-envelope"})])},function(){var s=this,a=s._self._c;return a("span",{staticClass:"input-group-text"},[a("i",{staticClass:"fas fa-lock"})])},function(){var s=this,a=s._self._c;return a("div",{staticClass:"row mt-4 g-3"},[a("div",{staticClass:"col-md-4"},[a("div",{staticClass:"card h-100 border-0 shadow-sm"},[a("div",{staticClass:"card-body text-center"},[a("i",{staticClass:"fas fa-user fa-2x text-success mb-2"}),a("h5",{staticClass:"card-title"},[s._v("Customer")]),a("p",{staticClass:"card-text small"},[s._v("Book and manage services")])])])]),a("div",{staticClass:"col-md-4"},[a("div",{staticClass:"card h-100 border-0 shadow-sm"},[a("div",{staticClass:"card-body text-center"},[a("i",{staticClass:"fas fa-user-tie fa-2x text-info mb-2"}),a("h5",{staticClass:"card-title"},[s._v("Professional")]),a("p",{staticClass:"card-text small"},[s._v("Provide services")])])])])])}],o=t(844);const i={name:"LoginView",data(){return{formData:{email:"",password:""},loading:!1,error:null,errors:{},loginError:"",isLoading:!1,showPassword:!1,redirect:null}},methods:{togglePassword(){this.showPassword=!this.showPassword},validateForm(){this.errors={};let s=!0;return this.formData.email?/\S+@\S+\.\S+/.test(this.formData.email)||(this.errors.email="Please enter a valid email address",s=!1):(this.errors.email="Email is required",s=!1),this.formData.password||(this.errors.password="Password is required",s=!1),s},async handleSubmit(){if(this.validateForm()){this.isLoading=!0,this.loginError="";try{const s={email:this.formData.email.trim(),password:this.formData.password};console.log("Attempting login for:",s.email);const a=await o.y1.login(s);if(console.log("Login successful, received token"),a&&a.user)if(console.log(`Authenticated as ${a.user.role}`),this.redirect)console.log(`Redirecting to: ${this.redirect}`),this.$router.push(this.redirect);else{const s=`/${a.user.role}/dashboard`;console.log(`No redirect specified, navigating to dashboard: ${s}`),this.$router.push(s)}else console.warn("Login successful but user data is missing");this.formData.email="",this.formData.password=""}catch(s){s.response&&s.response.data?this.loginError=s.response.data.error||s.response.data.message||"Login failed. Please check your credentials.":this.loginError=s.message||"An error occurred during login. Please try again.",console.error("Login error:",this.loginError)}finally{this.isLoading=!1}}}},created(){this.redirect=this.$route.query.redirect||null,console.log(`Redirect URL from query: ${this.redirect}`),localStorage.removeItem("token"),localStorage.removeItem("user")}},l=i;var n=t(656),d=(0,n.A)(l,r,e,!1,null,null,null);const c=d.exports}}]);